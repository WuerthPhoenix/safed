WOLFSSL=$(./src/checkgnutls.sh)
if [ -n "$WOLFSSL" ]
then
    echo "[+] Info: wolfssl is already installed. Next steps: ./configure && make && ./install.sh"
    exit 0
fi

cd ..
git submodule update --init
cd safed-agent/external/wolfssl
./autogen.sh && ./configure --libdir=/usr/lib64 --enable-tls13 --disable-oldtls && ../wolfsslfix && make && make install
if [ "$?" -ne 0 ]
then
    echo "[-] Error: failed to build and install wolfssl. Exit ..."
    cd ../../..
    exit 1
fi

rm -f /etc/ld.so.cache && /sbin/ldconfig
cd ../..
echo "[+] Info: wolfssl has been installed. Next steps: ./configure && make && ./install.sh" 
exit 0
